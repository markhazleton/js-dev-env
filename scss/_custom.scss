// _custom.scss
//
// Custom styles for your project.
// - Uses the Sass module system (@use)
// - All variables and mixins are namespaced
// - Responsive and theme-aware styles
//
@use './_variables' as variables;
@use "bootstrap/scss/bootstrap" as bootstrap;

// Layout
.flex-layout {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.flex-main {
  flex: 1 0 auto; /* Changed to flex: 1 0 auto for better cross-browser compatibility */
}

// Navigation
.navbar {
  // Auto theme styling based on dark/light mode
  background-color: var(--bs-body-bg);
  border-bottom: 1px solid var(--bs-border-color);
  
  // Add a subtle transition
  transition: background-color 0.3s ease;
}

.navbar-brand {
  font-weight: 600;
  
  .bi {
    margin-right: 0.25rem;
  }
}

.nav-link.active {
  font-weight: 600;
  color: variables.$primary !important;
}

// Page components
.page-header {
  h1 {
    color: variables.$primary;
    margin-bottom: 1rem;
  }
}

.content-section {
  padding: 1.5rem;
  background-color: var(--bs-body-bg);
  border: 1px solid var(--bs-border-color);
  border-radius: 0.375rem;
  box-shadow: variables.$custom-card-shadow-dark;
  
  img {
    max-width: 100%;
    height: auto;
  }
}

// Forms
.form-control:focus {
  border-color: lighten(variables.$primary, 20%);
  box-shadow: 0 0 0 0.25rem rgba(variables.$primary, 0.25);
}

// Cards
.card {
  background-color: var(--bs-body-bg);
  border-color: var(--bs-border-color);
}

// Alerts
.alert {
  // Ensure alert link color has proper contrast in both themes
  .alert-link {
    text-decoration: underline;
    font-weight: 600;
  }
}

// Footer
.footer {
  padding-bottom: 1.5rem !important;
  background-color: var(--bs-body-bg);
  border-top: 1px solid var(--bs-border-color);
  transition: background-color 0.3s ease;
  flex-shrink: 0; /* Prevent footer from shrinking */
  position: sticky;
  bottom: 0;
  width: 100%;
  z-index: 10;
  
  .bi {
    font-size: 1.25rem;
    transition: color 0.2s ease-in-out;
    
    &:hover {
      color: variables.$primary !important;
    }
  }
  
  a {
    text-decoration: none;
    transition: color 0.2s ease-in-out;
    
    &:hover {
      color: variables.$primary !important;
    }
  }
}

// Dark mode specific styles
[data-bs-theme="dark"] {
  .navbar {
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.15);
  }
  
  .footer .text-muted {
    color: rgba(255, 255, 255, 0.75) !important;
  }
  
  .content-section {
    box-shadow: variables.$custom-card-shadow-dark;
  }

  // Improve contrast for links in dark mode
  a:not(.btn):not(.nav-link) {
    text-decoration-thickness: 1px;
    text-underline-offset: 2px;
  }
  
  // Better contrast for alert colors in dark mode
  .alert-warning {
    color: #f8d7a5;
  }
  
  .alert-danger {
    color: #f8c9c5;
  }
}

// Light mode specific styles
[data-bs-theme="light"] {
  .content-section {
    box-shadow: variables.$custom-card-shadow-light;
  }
  
  // Ensure text elements have sufficient contrast
  .text-muted {
    color: rgba(0, 0, 0, 0.65) !important;
  }
}

// Responsive adjustments
@include bootstrap.media-breakpoint-down(md) {
  .container {
    padding-left: 1.25rem;
    padding-right: 1.25rem;
  }
  
  // Fix spacing on mobile
  main.container {
    padding-bottom: 5rem !important;
  }
}

// Style adjustments for theme toggle
.theme-toggle-wrapper {
  display: inline-flex;
  align-items: center;
  margin-left: 1rem;
  
  .form-check {
    margin-bottom: 0;
  }
  
  .form-check-label {
    cursor: pointer;
    padding: 0.25rem;
    transition: color 0.2s ease;
    
    &:hover {
      color: variables.$primary;
    }
  }
}

// Song Detail Page Styles
// =====================

// Background gradient for hero section
.bg-gradient {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white !important;
  
  // Force all text in gradient to be white - maximum specificity
  &,
  *,
  h1, h2, h3, h4, h5, h6,
  p, span, div, strong,
  .display-4, .fw-bold, .mb-3, .mb-4,
  #song-title, #song-channel, #channel-name,
  #song-views, #song-duration, #song-followers,
  #rank-number, #song-rank,
  .badge, .badge *,
  .bi, i.bi, i[class*="bi-"] {
    color: white !important;
  }
  
  .text-muted {
    color: rgba(255, 255, 255, 0.8) !important;
  }
  
  .text-primary {
    color: #87ceeb !important; // Light blue for better contrast
  }
  
  .text-success {
    color: #90ee90 !important; // Light green for better contrast
  }
  
  .text-warning {
    color: #ffeb3b !important; // Bright yellow for better contrast
  }
  
  small {
    color: rgba(255, 255, 255, 0.9) !important;
  }
  
  .badge {
    background-color: rgba(255, 255, 255, 0.2) !important;
    border: 1px solid rgba(255, 255, 255, 0.3);
  }
}

// Statistics section fixes
.bg-light {
  background-color: var(--bs-light) !important;
  transition: background-color 0.3s ease, color 0.3s ease;
}

// Light mode specific fixes - ensure proper contrast
[data-bs-theme="light"] {
  .bg-light {
    background-color: #f8f9fa !important;
    border: 1px solid #dee2e6;
    
    .text-primary,
    h2.text-primary,
    h4.text-primary {
      color: #0d6efd !important;
    }
    
    .text-success,
    h4.text-success {
      color: #198754 !important;
    }
    
    .text-warning,
    h4.text-warning {
      color: #dc6600 !important; // Darker orange for better contrast on light background
    }
    
    .text-muted,
    small {
      color: #6c757d !important;
    }
    
    h2, h4 {
      color: #212529 !important;
    }
  }
  
  // Override ANY Bootstrap text color classes in light mode within gradient
  .bg-gradient {
    .text-muted,
    .text-primary,
    .text-success,
    .text-warning,
    .text-info,
    .text-secondary,
    .text-dark,
    .text-light {
      color: white !important;
    }
  }
}

// Dark mode specific fixes  
[data-bs-theme="dark"] {
  .bg-light {
    background-color: var(--bs-gray-800) !important;
    border: 1px solid var(--bs-gray-700);
    
    .text-primary {
      color: #87ceeb !important;
    }
    
    .text-success {
      color: #90ee90 !important;
    }
    
    .text-warning {
      color: #ffeb3b !important;
    }
    
    .text-muted,
    small {
      color: rgba(255, 255, 255, 0.8) !important;
    }
  }
}

// Thumbnail section fixes
#no-thumbnail {
  transition: background-color 0.3s ease, color 0.3s ease;
}

[data-bs-theme="dark"] {
  #no-thumbnail {
    background-color: var(--bs-gray-800) !important;
    border: 1px solid var(--bs-gray-700);
    
    .text-muted {
      color: rgba(255, 255, 255, 0.7) !important;
    }
    
    .bi {
      color: rgba(255, 255, 255, 0.5) !important;
    }
  }
}

// Description content improvements
.description-content {
  line-height: 1.6;
  word-wrap: break-word;
  
  a {
    word-break: break-all;
    transition: color 0.2s ease;
  }
}

[data-bs-theme="dark"] {
  .description-content a {
    color: #87ceeb !important;
    
    &:hover {
      color: #b0e0e6 !important;
    }
  }
  
  .card-body .text-muted {
    color: rgba(255, 255, 255, 0.75) !important;
  }
}

[data-bs-theme="light"] {
  .card-body .text-muted {
    color: rgba(0, 0, 0, 0.6) !important;
  }
}

// Mobile responsive adjustments for song detail
@include bootstrap.media-breakpoint-down(md) {
  .display-4 {
    font-size: 2rem;
  }
  
  .btn-group {
    flex-direction: column;
    
    .btn {
      border-radius: 0.375rem !important;
      margin-bottom: 0.5rem;
    }
  }
}