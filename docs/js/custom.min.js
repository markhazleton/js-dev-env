console.log("External song-detail.js loaded!"),(()=>{function e(){console.log("initializePage called");let a=document.getElementById("loading-container");var e=document.getElementById("error-container");let l=document.getElementById("song-container");var t=document.getElementById("error-message");if(a&&e&&l&&t){console.log("DOM elements found:",{loadingContainer:!!a,errorContainer:!!e,songContainer:!!l,errorMessage:!!t});var e=window.location.pathname.split("/").filter(e=>e),t=e.indexOf("song");let r=-1!==t&&e[t+1]?e[t+1]:"";function i(e,t){var n=(new DOMParser).parseFromString(t,"text/html");for(e.textContent="";n.body.firstChild;)e.appendChild(n.body.firstChild)}function s(e){console.log("showError called with:",e);var t=document.getElementById("loading-container"),n=document.getElementById("error-container"),o=document.getElementById("error-message");t&&n&&o?(t.classList.add("d-none"),o.textContent=e,n.classList.remove("d-none")):console.error("Error display elements not found, logging error only:",e)}console.log("Song detail page loading for songId:",r),console.log("Current URL:",window.location.pathname),console.log("loadSongDetails called with songId:",r),e="/js-dev-env/data/youtube-top-100-songs-2025.json",console.log("Attempting to load from static data:",e),fetch(e).then(e=>{if(e.ok)return console.log("Static data fetched successfully"),e.json();throw console.error(`Static data fetch failed: ${e.status} `+e.statusText),new Error("Failed to load song data: "+e.statusText)}).then(t=>{if(console.log("Data parsed successfully, array length:",t.length),!Array.isArray(t))throw console.error("Expected array but got:",typeof t),new Error("Invalid data format");console.log("Loading from static JSON array");var o=parseInt(r)-1;if(console.log("Looking for song at index:",o,"(rank",r,")"),o<0||o>=t.length)throw console.error(`Song index ${o} out of range [0, ${t.length-1}]`),new Error(`Song #${r} not found`);t={...t[o],rank:parseInt(r),id:parseInt(r)};if(console.log("Song data loaded:",t.title),t.error)throw new Error(t.error);o=t,console.log("populateSongDetails called with:",o),t=["rank-number","song-title","channel-name","song-views","song-duration","song-followers","views-large","duration-large","followers-large","song-full-title","category-badge"].filter(e=>!document.getElementById(e));if(0<t.length)console.error("Missing required DOM elements:",t),s("Page structure is incomplete. Missing elements: "+t.join(", "));else{console.log("Setting basic info..."),document.getElementById("rank-number").textContent=o.rank||"N/A",document.getElementById("song-title").textContent=o.title||"Unknown Title",document.getElementById("channel-name").textContent=o.channel||"Unknown Channel",document.getElementById("song-views").textContent=o.views||"N/A",document.getElementById("song-duration").textContent=o.duration||"N/A",document.getElementById("song-followers").textContent=o.followers||"N/A",console.log("Setting large stats..."),document.getElementById("views-large").textContent=o.views||"N/A",document.getElementById("duration-large").textContent=o.duration||"N/A",document.getElementById("followers-large").textContent=o.followers||"N/A",console.log("Setting detailed info..."),document.getElementById("song-full-title").textContent=o.title||"Unknown Title",document.getElementById("category-badge").textContent=o.category||"Music",o.channelUrl?(document.getElementById("channel-link").href=o.channelUrl,document.getElementById("channel-url-container").classList.remove("d-none")):document.getElementById("channel-url-container").classList.add("d-none");{t=o.description;let r=document.getElementById("song-description"),a=document.getElementById("toggle-description"),e=document.getElementById("description-card");if(r&&e)if(t){let o=(e=>{let t=e=>{var t=document.createElement("div");return t.textContent=e,t.innerHTML},n=t(e);return n.replace(/https?:\/\/[^\s\n]+/g,function(e){return`<a href="${e.replace(/"/g,"&quot;")}" target="_blank" rel="noopener noreferrer" class="text-primary text-decoration-none">${t(e)} <i class="bi bi-box-arrow-up-right small"></i></a>`}).replace(/\n/g,"<br>")})(t);if(500<o.length){let t=o.substring(0,500)+"...",n=(i(r,t),a.classList.remove("d-none"),!1);a.onclick=function(){var e;n?(i(r,t),a.textContent="",(e=document.createElement("i")).className="bi bi-chevron-down me-1",a.appendChild(e),a.appendChild(document.createTextNode("Show More"))):(i(r,o),a.textContent="",(e=document.createElement("i")).className="bi bi-chevron-up me-1",a.appendChild(e),a.appendChild(document.createTextNode("Show Less"))),n=!n}}else i(r,o)}else e.classList.add("d-none");else console.log("Description elements not found, skipping description rendering")}{t=o.tags;let n=document.getElementById("song-tags"),e=document.getElementById("tags-card");n&&e?!t||0===(t=t.split(",").map(e=>e.trim()).filter(e=>e)).length?e.classList.add("d-none"):(n.textContent="",t.forEach(e=>{var t=document.createElement("span");t.className="badge bg-light text-dark border",t.textContent=e,n.appendChild(t),n.appendChild(document.createTextNode(" "))})):console.log("Tags elements not found, skipping tags rendering")}var e=parseInt(o.rank)||1,t=document.getElementById("prev-song"),n=document.getElementById("next-song");t&&n?(1<e?t.onclick=()=>window.location.href="/song/"+(e-1):t.disabled=!0,e<100?n.onclick=()=>window.location.href="/song/"+(e+1):n.disabled=!0):console.log("Navigation elements not found, skipping navigation setup"),document.title=`${o.title||"Unknown"} - ${o.channel||"Unknown"} | Song Details`}a.classList.add("d-none"),l.classList.remove("d-none")}).catch(e=>{console.error("Error loading song:",e),s(e.message||"Failed to load song details")})}else console.log("Not a song detail page, skipping initialization")}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()})(),document.addEventListener("DOMContentLoaded",function(){var e,t=document.getElementById("theme-demo-toggle");t&&(e=document.documentElement.getAttribute("data-bs-theme"),t.textContent="dark"===e?"Try Light Mode":"Try Dark Mode",t.addEventListener("click",function(){var e=document.documentElement,t="dark"===e.getAttribute("data-bs-theme")?"light":"dark";e.setAttribute("data-bs-theme",t),this.textContent="dark"==t?"Try Light Mode":"Try Dark Mode"}))}),document.addEventListener("DOMContentLoaded",()=>{let t=document.getElementById("darkModeToggle"),n=document.documentElement;let o=e=>{"dark"===e?(n.setAttribute("data-bs-theme","dark"),t&&t.nextElementSibling&&(t.checked=!0,(e=document.createElement("i")).className="bi bi-moon-fill",t.nextElementSibling.textContent="",t.nextElementSibling.appendChild(e))):(n.setAttribute("data-bs-theme","light"),t&&t.nextElementSibling&&(t.checked=!1,(e=document.createElement("i")).className="bi bi-sun-fill",t.nextElementSibling.textContent="",t.nextElementSibling.appendChild(e)))};o(localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),t&&t.addEventListener("change",e=>{e=e.target.checked?"dark":"light";localStorage.setItem("theme",e),o(e)}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{localStorage.getItem("theme")||o(e.matches?"dark":"light")})}),document.addEventListener("DOMContentLoaded",function(){"undefined"!=typeof hljs&&document.querySelectorAll("pre code").forEach(e=>{hljs.highlightElement(e)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var e=this.getAttribute("href"),t=document.querySelector(e);t&&(t=t.getBoundingClientRect().top+window.pageYOffset-20,window.scrollTo({top:t,behavior:"smooth"}),history.pushState(null,null,e))})}),document.querySelectorAll(".code-example pre").forEach((e,t)=>{var n=document.createElement("button");n.className="btn btn-sm btn-outline-primary copy-btn",n.innerHTML='<i class="bi bi-clipboard"></i> Copy',n.setAttribute("data-index",t),e.parentNode.insertBefore(n,e),n.addEventListener("click",function(){var e=this.nextElementSibling.querySelector("code").textContent;navigator.clipboard.writeText(e).then(()=>{let e=this.innerHTML;this.innerHTML='<i class="bi bi-check2"></i> Copied!',this.classList.remove("btn-outline-primary"),this.classList.add("btn-success"),setTimeout(()=>{this.innerHTML=e,this.classList.remove("btn-success"),this.classList.add("btn-outline-primary")},2e3)}).catch(e=>{console.error("Failed to copy text: ",e)})})});let e=document.querySelectorAll(".component-section"),t=document.querySelectorAll(".list-group-item");function n(){let n="";e.forEach(e=>{var t=e.offsetTop;window.pageYOffset>=t-100&&(n="#"+e.getAttribute("id"))}),t.forEach(e=>{e.classList.remove("active"),e.getAttribute("href")===n&&e.classList.add("active")})}n(),window.addEventListener("scroll",n)}),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".needs-validation");Array.from(e).forEach(t=>{t.addEventListener("submit",e=>{t.checkValidity()||(e.preventDefault(),e.stopPropagation()),t.classList.add("was-validated")},!1)}),document.querySelectorAll('input[type="password"].validate-strength').forEach(n=>{n.addEventListener("input",()=>{var e=n.value,t=n.nextElementSibling;e.length<8?(n.setCustomValidity("Password must be at least 8 characters"),t&&(t.textContent="Password is too short (min 8 characters)")):/[A-Z]/.test(e)?/[0-9]/.test(e)?(n.setCustomValidity(""),t&&(t.textContent="Password strength: good")):(n.setCustomValidity("Password must contain at least one number"),t&&(t.textContent="Add at least one number")):(n.setCustomValidity("Password must contain at least one uppercase letter"),t&&(t.textContent="Add at least one uppercase letter"))})})}),console.log("Custom JavaScript loaded!"),"serviceWorker"in navigator&&window.addEventListener("load",()=>{var e=window.location.pathname.includes("/js-dev-env/");let t;e=(t=e?"/js-dev-env/":"/")+"service-worker.js";navigator.serviceWorker.register(e).then(e=>{console.log("Service Worker registered with scope:",e.scope)}).catch(e=>{console.error("Service Worker registration failed:",e)})});